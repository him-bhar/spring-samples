<beans:beans xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
    http://www.springframework.org/schema/security
    http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    
    <http auto-config="true" use-expressions="true">
        <intercept-url access="hasRole('ROLE_ADMIN')" pattern="/admin/**"></intercept-url>
        <intercept-url access="hasRole('ROLE_USER')" pattern="/user/**"></intercept-url>
        <intercept-url access="permitAll" pattern="/logout"></intercept-url>
        <logout invalidate-session="true" logout-success-url="/index.html" logout-url="/logout"></logout>
        <form-login authentication-success-handler-ref="authenticationSuccessRedirecthandler"></form-login>
        <session-management invalid-session-url="/logout"></session-management>
    </http>

    <beans:bean id="authenticationSuccessRedirecthandler" class="gmc.gestaxi.controller.CustomAuthenticationHandler" />
<!--     <authentication-manager> -->
<!--         <authentication-provider> -->
<!--             <jdbc-user-service data-source-ref="dataSource" -->
<!--                                users-by-username-query="select username,password, enabled from Users where USERNAME=?" -->
<!--                                authorities-by-username-query="select u.username, ur.authority from USERS u, USERSROLES ur where u.user_id= ur.user_id and u.username=?" /> -->
<!--         </authentication-provider> -->
<!--     </authentication-manager> -->

<!-- <authentication-manager alias="authenticationManager"> -->
<!-- 	    <authentication-provider user-service-ref="userDetailsService"> -->
<!-- 	    	<password-encoder ref="encoder" /> -->
<!-- 	    </authentication-provider> -->
<!-- 	</authentication-manager> -->

<authentication-manager>
	  <authentication-provider>
		<user-service>
			<user name="test1" password="123456" authorities="ROLE_USER" />
			<user name="test2" password="123456" authorities="ROLE_ADMIN" />
			<user name="test3" password="123456" authorities="ROLE_MOT" />
		</user-service>
	  </authentication-provider>
	</authentication-manager>
	
<!-- 	<beans:bean id="encoder" class="org.springframework.security.crypto.password.StandardPasswordEncoder" /> -->

    <global-method-security secured-annotations="enabled" />
</beans:beans>
